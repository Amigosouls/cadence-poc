<span class="flex flex-row">
  <sqd-designer theme="light" [undoStackSize]="10" [definition]="definition"
    [toolboxConfiguration]="toolboxConfiguration" [stepsConfiguration]="stepsConfiguration"
    [validatorConfiguration]="validatorConfiguration" [controlBar]="true" [selectedStepId]="selectedStepId"
    [isReadonly]="isReadonly" [isToolboxCollapsed]="isToolboxCollapsed" [isEditorCollapsed]="isEditorCollapsed"
    [areEditorsHidden]="false" [rootEditor]="rootEditor" [stepEditor]="stepEditor" (onReady)="onDesignerReady($event)"
    (onDefinitionChanged)="onDefinitionChanged($event)" (onSelectedStepIdChanged)="onSelectedStepIdChanged($event)"
    (onIsToolboxCollapsedChanged)="onIsToolboxCollapsedChanged($event)"
    (onIsEditorCollapsedChanged)="onIsEditorCollapsedChanged($event)" [keyboard]="false">
  </sqd-designer>

  <ng-template #rootEditor let-editor>
    <!-- <h2>Root Editor</h2>


  <h3>Test Data</h3>
  <mat-form-field class="full-width">
    <input matInput type="number" [value]="editor.definition.properties.testData" [readonly]="editor.isReadonly"
      (input)="
        updateProperty(
          editor.definition.properties,
          'testData',
          $event,
          editor.context
        )
      " />
  </mat-form-field> -->

    <!-- <h3>Test Data</h3>
  <mat-form-field class="full-width">
    <input matInput type="number" [value]="editor.definition.properties.testData" [readonly]="editor.isReadonly"
      (input)="
        updateProperty(
          editor.definition.properties,
          'testData',
          $event,
          editor.context
        )
      " />
  </mat-form-field> -->
  </ng-template>

  <ng-template #stepEditor let-editor>
    <span class="config_modal">
      <p-dialog header="Set Configuration" [modal]="true" [(visible)]="visible" [style]="{ width: '30rem' }"
        [draggable]="false" (onHide)="toggleSelectedStepClicked()" (onShow)="reflectChanges()">
        <div class="flex flex-column gap-3">
          <span class="p-float-label w-full flex gap-2 flex-column">
            <label>Step Name</label>
            <input id="stepName" pInputText type="text" class="p-inputtext-sm w-full" [(ngModel)]="selectedStep.name"
              (blur)="
            updateStepName(
              editor,
              'name',
              $event,
              editor.context,
              true
            );
          " />
          </span>

          <div class="w-full gap-2" [ngClass]="toggle ? 'hidden ':'flex flex-column'">
            <label for="">Template</label>
            <select class="p-inputtext-sm w-full" pInputText optionLabel="name"
              [value]="editor.step.properties.emailTemplate" (input)="
          updateProperty(
            editor.step.properties,
            'emailTemplate',
            $event,
            editor.context
          )
        ">
              <option value="1">First Follow up</option>
              <option value="2">Second Follow up</option>
            </select>
          </div>

          <span class="p-float-label w-full flex gap-2 flex-column">
            <label>Email From</label>
            <input pInputText type="text" class="p-inputtext-sm w-full" [value]="editor.step.properties.mailFrom"
              [readonly]="editor.isReadonly" (input)="
            updateProperty(
              editor.step.properties,
              'mailFrom',
              $event,
              editor.context
            )
          " />
          </span>
          <span class="p-float-label w-full flex gap-2 flex-column">
            <label>Email To</label>
            <input pInputText type="text" class="p-inputtext-sm w-full" [value]="editor.step.properties.mailTo"
              [readonly]="editor.isReadonly" (input)="
            updateProperty(
              editor.step.properties,
              'mailTo',
              $event,
              editor.context
            )
          " />
          </span>
          <span class="flex w-full flex-column">
            <span class="flex w-full flex-column gap-2">
              <label for="date">Email trigger schedule</label>
              <input appendTo="body" pInputText type="text" class="p-inputtext-sm w-full"
                [value]="editor.step.properties.scheduledTime" (input)="
            updateProperty(
              editor.step.properties,
              'scheduledTime',
              $event,
              editor.context
            )
          " />
            </span>
            <div class="flex flex-column align-items-center">
              <!-- <div class="flex w-19rem flex-row gap-2 p-3 text-white"
              style="border: 1px rgb(255, 255, 255) solid;border-bottom: 0;border-top-right-radius: 5px;border-top-left-radius: 5px;background-color: #03b19e;">
              <span><b>{{selectedDaysValue}}</b></span>
              <span><b>{{selectedHoursValue}}</b></span>
              <span><b>{{selectedBasedOnValue}}</b></span>
            </div> -->
              <div
                style="border: 1px #CED4DA solid;border-top: 0% !important;background-color: #ffffff;width: 100%;border-radius: 5px;">
                <div class="flex flex-row justify-content-center gap-3 scroll_value">
                  <span class="w-5rem flex flex-column text-center">
                    <div class="pt-2">Days</div>
                    <ng-scroll-picker [style]="{'margin':'.5em 0em'}" [data]="data"
                      (change)="dayschange($event)"></ng-scroll-picker>
                  </span>
                  <span class="w-5rem flex flex-column text-center">
                    <div class="pt-2">Hours</div>
                    <ng-scroll-picker [style]="{'margin':'.5em 0em'}" [data]="data"
                      (change)="hourschange($event)"></ng-scroll-picker>
                  </span>
                  <span class="w-10rem flex flex-column text-center">
                    <div class="pt-2">Based On</div>
                    <ng-scroll-picker [style]="{'margin':'.5em 0em'}" [data]="data"
                      (change)="basedonchange($event)"></ng-scroll-picker>
                  </span>
                </div>
              </div>

            </div>
          </span>
        </div>


        <!-- <span class="flex flex-column gap-2 mt-1">
        <div class="mb-3 form-check">
          <input type="checkbox" class="form-check-input" id="check1" [checked]="toggle"
            (change)="toggleCheckbox($event)" />
          <label class="form-check-label" for="check1">IsCustomTemplate</label>
        </div>
      </span> -->

        <!-- <div class="container" [hidden]="!toggle">
        <div class="text-black p-3" draggable="true" (dragstart)="onDragStart($event, '#Customer_Name#')">
          #Customer_Name#
        </div>
        <div class="text-black p-3" draggable="true" (dragstart)="onDragStart($event, '#Invoice_Number#')">
          #Invoice_Number#
        </div>
        <div class="text-black p-3" draggable="true" (dragstart)="onDragStart($event, '#Balance_Amount#')">
          #Balance_Amount#
        </div>
        <h4>Custom Template Editor</h4>
        <angular-editor [config]="config" (focus)="onEditorFocus($event)"
          (blur)="onEditorBlur($event)"></angular-editor>
      </div> -->
      </p-dialog>
    </span>

    <!-- 
    <mat-tab-group>
      <mat-tab label="Details">
        <h3>Mail</h3>
        <h5>To Mail</h5>
        <mat-form-field class="full-width">
         
        </mat-form-field>
        <h5>Scheduled Time</h5>
        <mat-form-field class="full-width">
          <input
            matInput
            type="text"
            [value]="editor.step.properties.scheduled"
            [readonly]="editor.isReadonly"
            (input)="
              updateProperty(
                editor.step.properties,
                'scheduled',
                $event,
                editor.context
              )
            "
          />
        </mat-form-field>
      </mat-tab>
    </mat-tab-group> -->
    <!-- <div>
    <h2>Job Editor</h2>
    <mat-tab-group>
      <mat-tab label="Details">
        <h3>Job</h3>
        <mat-form-field class="full-width">
          <input matInput type="number" [value]="editor.step.properties.testData" [readonly]="editor.isReadonly"
            (input)="
              updateProperty(
                editor.step.properties,
                'testData',
                $event,
                editor.context
              )
            " />
        </mat-form-field>
      </mat-tab>
    </mat-tab-group>
  </div> -->
  </ng-template>

  <!-- <div class="block">
  <button mat-raised-button color="primary" (click)="reloadDefinitionClicked()">
    Reload definition
  </button>
  &nbsp;
  <button mat-raised-button color="primary" (click)="toggleReadonlyClicked()">
    {{ isReadonly ? "Enable editing" : "Disable editing" }}
  </button>
  &nbsp;
  <button mat-raised-button color="primary" (click)="toggleSelectedStepClicked()">
    {{ selectedStepId ? "Unselect" : "Select first" }}
  </button>
  &nbsp;
  <button mat-raised-button color="primary" (click)="toggleToolboxClicked()">
    {{ isToolboxCollapsed ? "Show toolbox" : "Hide toolbox" }}
  </button>
  &nbsp;
  <button mat-raised-button color="primary" (click)="toggleEditorClicked()">
    {{ isEditorCollapsed ? "Show editor" : "Hide editor" }}
  </button>
  &nbsp; Is valid: <strong>{{ isValid }}</strong>
</div> -->
</span>

<div class="block">
  <mat-form-field class="full-width flex-1s">
    <textarea matInput cols="120" rows="16" readonly>{{
      definitionJSON
    }}</textarea>
  </mat-form-field>
</div>
<!-- <p-dialog [visible]="true">
  <span class="">
   
  </span>
</p-dialog> -->